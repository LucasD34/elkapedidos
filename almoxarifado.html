<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Almoxarifado</title>
<style>
body { font-family: Arial, sans-serif; background:#ffffff; margin:0; padding:0; }
header { background:#1e3d59; color:white; padding:15px; text-align:center; }
table { width:100%; border-collapse:collapse; margin-top:15px; background:white; }
th, td { border:1px solid #ccc; padding:8px; text-align:left; }
th { background:#eee; }
input, select, textarea, button { padding:5px; margin-right:10px; }
textarea { resize: vertical; }
.btn { background:#1e3d59; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer; }
.btn:hover { background:#2e5b84; }
.form-linha { margin-bottom:10px; }
label { font-weight:bold; margin-right:5px; }
.status-pendente { color:red; font-weight:bold; }
.status-enviado { color:green; font-weight:bold; }
.separador { background:#dcdcdc; text-align:center; font-weight:bold; padding:5px; }
.logo-container {
  width: 100%;
  justify-content: flex-start;/* ou center se quiser centralizar tudo*/
  display: flex;
  align-items: center;
  gap: 50px; /* espa√ßo entre as imagens */
  margin: 10px 15px;
  background-color: #ffffff; /*fundo branco puro*/
  margin: 10px;
}

.logo-container img {
  height: 100px; /* ajusta o tamanho igual pra todas */
  width: auto;
  border-radius: 8px; /* opcional: cantos levemente arredondados */
}
/* Responsividade geral */
@media (max-width: 768px) {
  body {
    padding: 10px;
  }

  header, .header {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .logo-container {
    flex-wrap: wrap;
    justify-content: center;
  }

  .logo-elka {
    width: 80px;
    margin: 5px;
  }

  .table-container, table {
    width: 100%;
    overflow-x: auto;
    display: block;
  }

  th, td {
    font-size: 14px;
    padding: 8px;
  }

  button, .btn {
    width: 100%;
    margin: 5px 0;
  }

  .input-observacao {
    width: 100%;
  }
}

/* ====== RESPONSIVIDADE ====== */
@media (max-width: 768px) {
  .logo-container {
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
  }

  .logo-container img {
    height: 70px;
  }

  table, th, td {
    font-size: 12px;
    padding: 5px;
  }

  header h1 {
    font-size: 18px;
  }

  button {
    padding: 4px 8px;
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .logo-container img {
    height: 50px;
  }

  header h1 {
    font-size: 16px;
  }

  .input-observacao {
    width: 100%;
    font-size: 12px;
  }
}


</style>



</head>
<body>

<div class="logo-container">
  <img src="logo-elka.png" alt="Logo Elka" class="logo-elka">
  <img src="caca.png" alt="Brinquedo Cac√°" class="logo-extra">
  <img src="dino.png" alt="Brinquedo Dino" class="logo-extra">
  <img src="bibi.png" alt="brinquedo bibi" class="logo-extra">
  <img src="pinos.png" alt="brinquedo pinos" class="logo-extra">
  <img src="stitch.png" alt="brinquedo stitch" class="logo-extra">
  <img src="angel.png" alt="brinquedo angel" class="logo-extra">
  <img src="roby.png" alt="brinquedo roby" class="logo-extra"> 
  <img src="zoom.png" alt="brinquedo zoom" class="logo-extra">  
<!-- pode adicionar mais imagens abaixo -->
  <!-- <img src="outra.png" alt="Outro brinquedo" class="logo-extra"> -->
</div>


<header><h1>Almoxarifado - Registrar Pedidos</h1></header>

<div style="padding:20px;">
<form id="formAlmoxarifado" onsubmit="enviarPedido(event)">
<div class="form-linha">
<label>Encarregada(o):</label>
<input type="text" id="encarregada" placeholder="Nome da encarregada">
</div>
<div class="form-linha">
<label>Refer√™ncia:</label>
<input type="text" id="referencia" placeholder="Digite a refer√™ncia">
</div>
<div class="form-linha">
<label>Material:</label>
<select id="material">
<option value="">Selecione</option>
<option value="Todos os Itens">Todos os Itens</option>
      <option value="Abra√ßadeira">Abra√ßadeira</option>
      <option value="Apito">Apito</option>
      <option value="Blister">Blister</option>
      <option value="Caixa master">Caixa master</option>
      <option value="Cartucho">Cartucho</option>
      <option value="Cart√£o">Cart√£o</option>
      <option value="Cartela">Cartela</option>
      <option value="Cinta vin√≠lica">Cinta vin√≠lica</option>
      <option value="Complemento">Complemento</option>
      <option value="Cord√£o">Cord√£o</option>
      <option value="El√°stico">El√°stico</option>
      <option value="Espuma">Espuma</option>
      <option value="Eixo">Eixo</option>
      <option value="Fita Durex">Fita Durex</option>
      <option value="Etiqueta">Etiqueta</option>
      <option value="Faixa">Faixa</option>
      <option value="Mangueira">Mangueira</option> 
      <option value="Guache">Guache</option>
      <option value="M√≥dulo som">M√≥dulo som</option>
      <option value="Mola">Mola</option>
      <option value="Onda B">Onda B</option>
      <option value="Papel gomado">Papel gomado</option>
      <option value="Parafuso">Parafuso</option>
      <option value="Pincel">Pincel</option>
      <option value="Rede">Rede</option>
      <option value="Regra">Regra</option>
      <option value="Sanfona">Sanfona</option>
      <option value="Suporte">Suporte</option>
      <option value="Tabuleiro">Tabuleiro</option>
      <option value="Tampa">Tampa</option>
      <option value="Tinta">Tinta</option>
      <option value="TNT">TNT</option>
      <option value="Outros">Outros</option>
</select>
</div>
<div class="form-linha">
<label>Quantidade:</label>
<input type="text" id="quantidade" placeholder="Digite a quantidade">
</div>
<div class="form-linha">
<label>Observa√ß√£o:</label>
<textarea id="observacao" rows="2" placeholder="Observa√ß√µes do item"></textarea>
</div>
<button type="button" class="btn" onclick="adicionarItem()">Adicionar Item</button>
<button type="submit" class="btn">Enviar Pedido</button>
</form>

<h3>Itens do Pedido</h3>
<table id="listaItens">
<thead>
<tr><th>Material</th><th>Refer√™ncia</th><th>Quantidade</th><th>Observa√ß√£o</th><th>A√ß√£o</th></tr>
</thead>
<tbody></tbody>
</table>

<h3>üìã Pedidos Registrados</h3>
<table id="tabelaPedidos">
<thead>
<tr>
<th>Pedido</th>
<th>Encarregada</th>
<th>Material</th>
<th>Refer√™ncia</th>
<th>Qtd</th>
<th>Observa√ß√£o</th>
<th>Data</th>
<th>Status</th>
<th>Data/Hora Envio</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCY-4txbL6nXugFoaIqmosdNqF9LTDg3e4",
  authDomain: "elkapedidos.firebaseapp.com",
  databaseURL: "https://elkapedidos-default-rtdb.firebaseio.com",
  projectId: "elkapedidos",
  storageBucket: "elkapedidos.firebasestorage.app",
  messagingSenderId: "787077956763",
  appId: "1:787077956763:web:bc796d2afef94caae6723e",
  measurementId: "G-FHHX0GH6FT"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
</script>

<script>
let itensPedido = [];

// --- Adicionar Item ---
function adicionarItem() {
  const material = document.getElementById('material').value;
  const referencia = document.getElementById('referencia').value;
  const quantidade = document.getElementById('quantidade').value;
  const observacao = document.getElementById('observacao').value;

  if (!material || !quantidade || !referencia) {
    alert("Preencha Material, Refer√™ncia e Quantidade!");
    return;
  }

  itensPedido.push({ material, referencia, quantidade, observacao });
  atualizarListaItens();

  document.getElementById('material').value = "";
  document.getElementById('quantidade').value = "";
  document.getElementById('observacao').value = "";
}

// --- Remover Item ---
function removerItem(i) {
  itensPedido.splice(i, 1);
  atualizarListaItens();
}

// --- Atualizar Lista Itens ---
function atualizarListaItens() {
  const tbody = document.querySelector('#listaItens tbody');
  tbody.innerHTML = "";
  itensPedido.forEach((item, i) => {
    const row = tbody.insertRow();
    row.insertCell(0).textContent = item.material;
    row.insertCell(1).textContent = item.referencia;
    row.insertCell(2).textContent = item.quantidade;
    row.insertCell(3).textContent = item.observacao;
    const btnCell = row.insertCell(4);
    const btn = document.createElement('button');
    btn.textContent = "Remover";
    btn.className = "btn";
    btn.onclick = () => removerItem(i);
    btnCell.appendChild(btn);
  });
}

// --- Firebase ---
async function pegarPedidosFirebase() {
  const snapshot = await db.ref('pedidos').get();
  return snapshot.exists() ? Object.values(snapshot.val()) : [];
}

function salvarPedidosFirebase(pedidos) {
  db.ref('pedidos').set(pedidos);
}

// --- Enviar Pedido ---
async function enviarPedido(e) {
  e.preventDefault();

  const encarregada = document.getElementById('encarregada').value;
  const referencia = document.getElementById('referencia').value;

  if (!encarregada || !referencia) {
    alert("Preencha Encarregada e Refer√™ncia!");
    return;
  }

  // Permitir enviar mesmo sem preencher os campos de item,
  // desde que j√° existam itens adicionados.
  if (itensPedido.length === 0) {
    alert("Adicione pelo menos um item antes de enviar!");
    return;
  }

  let pedidos = await pegarPedidosFirebase();
  const data = new Date().toLocaleString('pt-BR');
  let maxNumero = pedidos.length > 0 ? Math.max(...pedidos.map(p => p.numero)) : 0;

  itensPedido.forEach(item => {
    maxNumero++;
    pedidos.push({
      id: Date.now().toString() + Math.random().toString(16),
      numero: maxNumero,
      encarregada,
      material: item.material,
      referencia: item.referencia,
      quantidade: item.quantidade,
      observacao: item.observacao,
      data,
      status: "Pendente",
      dataEnvio: "" // ser√° preenchido quando a Elka 2 marcar como enviado
    });
  });

  salvarPedidosFirebase(pedidos);
  itensPedido = [];
  atualizarListaItens();
  document.getElementById('formAlmoxarifado').reset();
  alert("‚úÖ Pedido enviado com sucesso!");
}
// --- Exibir Pedidos com Data/Hora Envio ---
async function carregarPedidos() {
  const tabela = document.querySelector('#tabelaPedidos tbody');
  tabela.innerHTML = ""; // limpa tudo antes de desenhar novamente

  let pedidos = await pegarPedidosFirebase();
  pedidos = pedidos.slice().reverse();

  const pendentes = pedidos.filter(p => p.status === "Pendente");
  const enviados = pedidos.filter(p => p.status === "Enviado");

  // --- Se houver pendentes ---
  if (pendentes.length > 0) {
    const sepPend = tabela.insertRow();
    const tdPend = sepPend.insertCell();
    tdPend.colSpan = 9;
    tdPend.className = 'separador';
    tdPend.textContent = `üì¶ Pendentes (${pendentes.length})`;

    pendentes.forEach(p => {
      const linha = tabela.insertRow();
      linha.insertCell(0).textContent = p.numero;
      linha.insertCell(1).textContent = p.encarregada;
      linha.insertCell(2).textContent = p.material;
      linha.insertCell(3).textContent = p.referencia;
      linha.insertCell(4).textContent = p.quantidade;
      linha.insertCell(5).innerHTML = `<span style="color:green; font-weight:bold;">${p.observacao || ''}</span>`;
      linha.insertCell(6).textContent = p.data;
      const st = linha.insertCell(7);
      st.textContent = p.status;
      st.className = "status-pendente";
      linha.insertCell(8).textContent = "-";
    });
  }

  // --- Se houver enviados ---
  if (enviados.length > 0) {
    const sepEnv = tabela.insertRow();
    const tdEnv = sepEnv.insertCell();
    tdEnv.colSpan = 9;
    tdEnv.className = 'separador';
    tdEnv.textContent = `‚úÖ Enviados (${enviados.length})`;

    enviados.forEach(p => {
      const linha = tabela.insertRow();
      linha.insertCell(0).textContent = p.numero;
      linha.insertCell(1).textContent = p.encarregada;
      linha.insertCell(2).textContent = p.material;
      linha.insertCell(3).textContent = p.referencia;
      linha.insertCell(4).textContent = p.quantidade;
      linha.insertCell(5).innerHTML = `<span style="color:red;font-weight:bold;">${p.observacao || ''}</span>`;
      linha.insertCell(6).textContent = p.data;
      const st = linha.insertCell(7);
      st.textContent = p.status;
      st.className = "status-enviado";
      linha.insertCell(8).textContent = p.dataEnvio ? p.dataEnvio : "-";
    });
  }
}


// --- Atualiza√ß√£o em tempo real ---
db.ref('pedidos').on('value', carregarPedidos);

</script>

</body>
</html>


